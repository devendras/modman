<?php
 class Omx_Hooks_GiftcertificateController extends Omx_Hooks_Controller_Abstract { public function indexAction() { $this->_forward('noRoute'); } public function checkAction() { $this->loadLayout(); $this->renderLayout(); } public function addAction() { $data = $this->getRequest()->getPost(); $gcCode = Mage::helper('hooks')->noXSS($data['giftcertificate_code']); try { Mage::getModel('hooks/giftcertificate_certificate', $gcCode) ->addToCart(); Mage::getSingleton('checkout/session')->addSuccess( $this->__( 'Gift Certificate "%s" was added.', Mage::helper('core')->htmlEscape($gcCode) ) ); } catch (Mage_Core_Exception $e) { Mage::getSingleton('checkout/session')->addError( $e->getMessage() ); } $this->setRedirectDesitination(); $this->_redirect($this->_redirect); } public function removeAction() { $this->setRedirectDesitination(); Mage::getModel('hooks/giftcertificate_certificate') ->unsetCartCertificates(); if($this->_redirect == $this->_redirectPath['cart']) { Mage::getSingleton('checkout/session')->addSuccess( $this->__('Gift Certificate has been removed from cart.' ) ); } $this->_redirect($this->_redirect); } }