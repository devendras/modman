<?php
class Omx_Hooks_Block_Omxpricing_Checkout_Onepage extends Mage_Checkout_Block_Onepage { public function _construct() { parent::_construct(); } public function getSteps() { $steps = array(); $steps = parent::getSteps(); $modifiedSteps = array(); foreach($steps as $step=>$stepData) { $modifiedSteps[$step] = $stepData; if($step == 'shipping_method') { $modifiedSteps['omxdiscount'] = $this->getCheckout()->getStepData('omxdiscount'); } } return $modifiedSteps; } protected function _prepareLayout() { parent::_prepareLayout(); $layout = $this->getLayout(); $head = $layout->getBlock('head'); if($head) { $layout->getBlock('head')->addItem('skin_js', 'js/hooks/hooks_opcheckout.js' ); } return $this; } } 