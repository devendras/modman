<?php
 class Omx_Hooks_Block_Giftcertificate_Checkout_Cart_Giftcardaccount extends Enterprise_GiftCardAccount_Block_Checkout_Cart_Giftcardaccount { protected $giftCertBlock; protected function _construct() { parent::_construct(); } protected function _prepareLayout() { parent::_prepareLayout(); $this->loadGiftCertBlock(); return $this; } protected function loadGiftCertBlock() { $settings = Mage::getModel('hooks/settings') ->getCollection() ->addFilter('name', 'useOmxGiftCertificates') ->load() ->getData('useOmxGiftCertificates'); if($useOmxCertificates = $settings[0]['value']) { $this->giftCertBlock = $this ->getLayout() ->createBlock('hooks/giftcertificate_cart'); } else { $block = get_parent_class($this); if (class_exists($block, false) || mageFindClassFile($block)) { $block = new $block(NULL); } if (!$block instanceof Mage_Core_Block_Abstract) { Mage::throwException(Mage::helper('core')->__('Invalid block type: %s', $block)); } $this->giftCertBlock = $block->setTemplate('giftcardaccount/cart/block.phtml'); }; } }