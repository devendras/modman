<?php
 class Omx_Hooks_Model_Order_Transfer { static public function send ($order) { $xmlObject = Mage::getModel('hooks/xml_order_appending_request', $order); if ($xmlObject instanceof Omx_Hooks_Model_Xml_Order_Appending_Request) { $omx_now = Zend_Date::now(); $omx_now->setTimezone('America/New_York'); $credentials = array( 'xml' => $xmlObject, 'order_id' => $order->getIncrementId(), 'status' => 0, 'response' => "", 'timestamp' => $omx_now->toString("yyyy-MM-dd HH:mm:ss") ); $connector = Mage::getModel('hooks/connector'); return $connector->callOmx(Omx_Hooks_Model_Connector::CALL_TYPE_UDOA, $credentials); } return false; } static public function getFromOrder ($order) { if ($order instanceof Mage_Sales_Model_Order && $order->getOmxOrderId() > 1) { $xmlObject = Mage::getModel('hooks/xml_order_information_request_from_order', $order->getOmxOrderId()); if ($xmlObject instanceof Omx_Hooks_Model_Xml_Order_Information_Request_From_Order) { $credentials = array( 'xml' => $xmlObject ); $connector = Mage::getModel('hooks/connector'); return $connector->callOmx(Omx_Hooks_Model_Connector::CALL_TYPE_OIR, $credentials); } } else { $xmlObject = Mage::getModel('hooks/xml_order_information_request_from_magento', $order->getIncrementId()); if ($xmlObject instanceof Omx_Hooks_Model_Xml_Order_Information_Request_From_Magento) { $credentials = array( 'xml' => $xmlObject ); $connector = Mage::getModel('hooks/connector'); return $connector->callOmx(Omx_Hooks_Model_Connector::CALL_TYPE_OIR, $credentials); } } return false; } static public function getFromHash ($hash) { $xmlObject = Mage::getModel('hooks/xml_order_information_request_from_hash', $hash); if ($xmlObject instanceof Omx_Hooks_Model_Xml_Order_Information_Request_From_Hash) { $credentials = array( 'xml' => $xmlObject ); $connector = Mage::getModel('hooks/connector'); return $connector->callOmx(Omx_Hooks_Model_Connector::CALL_TYPE_OIR, $credentials); } return false; } }